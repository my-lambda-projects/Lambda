<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>d3-notes</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <h1 id="dictonaries">Dictonaries</h1>
    <h4 id="in-python-dictonaries-are-hash-tables.">
      In python dictonaries are hash tables.
    </h4>
    <div class="sourceCode" id="cb1">
      <pre
        class="sourceCode py"
      ><code class="sourceCode python"><a class="sourceLine" id="cb1-1" title="1">[<span class="st">&#39;__class__&#39;</span>,</a>
<a class="sourceLine" id="cb1-2" title="2"> <span class="st">&#39;__contains__&#39;</span>,</a>
<a class="sourceLine" id="cb1-3" title="3"> <span class="st">&#39;__delattr__&#39;</span>,</a>
<a class="sourceLine" id="cb1-4" title="4"> <span class="st">&#39;__delitem__&#39;</span>,</a>
<a class="sourceLine" id="cb1-5" title="5"> <span class="st">&#39;__dir__&#39;</span>,</a>
<a class="sourceLine" id="cb1-6" title="6"> <span class="st">&#39;__doc__&#39;</span>,</a>
<a class="sourceLine" id="cb1-7" title="7"> <span class="st">&#39;__eq__&#39;</span>,</a>
<a class="sourceLine" id="cb1-8" title="8"> <span class="st">&#39;__format__&#39;</span>,</a>
<a class="sourceLine" id="cb1-9" title="9"> <span class="st">&#39;__ge__&#39;</span>,</a>
<a class="sourceLine" id="cb1-10" title="10"> <span class="st">&#39;__getattribute__&#39;</span>,</a>
<a class="sourceLine" id="cb1-11" title="11"> <span class="st">&#39;__getitem__&#39;</span>,</a>
<a class="sourceLine" id="cb1-12" title="12"> <span class="st">&#39;__gt__&#39;</span>,</a>
<a class="sourceLine" id="cb1-13" title="13"> <span class="st">&#39;__hash__&#39;</span>,</a>
<a class="sourceLine" id="cb1-14" title="14"> <span class="st">&#39;__init__&#39;</span>,</a>
<a class="sourceLine" id="cb1-15" title="15"> <span class="st">&#39;__init_subclass__&#39;</span>,</a>
<a class="sourceLine" id="cb1-16" title="16"> <span class="st">&#39;__iter__&#39;</span>,</a>
<a class="sourceLine" id="cb1-17" title="17"> <span class="st">&#39;__le__&#39;</span>,</a>
<a class="sourceLine" id="cb1-18" title="18"> <span class="st">&#39;__len__&#39;</span>,</a>
<a class="sourceLine" id="cb1-19" title="19"> <span class="st">&#39;__lt__&#39;</span>,</a>
<a class="sourceLine" id="cb1-20" title="20"> <span class="st">&#39;__ne__&#39;</span>,</a>
<a class="sourceLine" id="cb1-21" title="21"> <span class="st">&#39;__new__&#39;</span>,</a>
<a class="sourceLine" id="cb1-22" title="22"> <span class="st">&#39;__reduce__&#39;</span>,</a>
<a class="sourceLine" id="cb1-23" title="23"> <span class="st">&#39;__reduce_ex__&#39;</span>,</a>
<a class="sourceLine" id="cb1-24" title="24"> <span class="st">&#39;__repr__&#39;</span>,</a>
<a class="sourceLine" id="cb1-25" title="25"> <span class="st">&#39;__setattr__&#39;</span>,</a>
<a class="sourceLine" id="cb1-26" title="26"> <span class="st">&#39;__setitem__&#39;</span>,</a>
<a class="sourceLine" id="cb1-27" title="27"> <span class="st">&#39;__sizeof__&#39;</span>,</a>
<a class="sourceLine" id="cb1-28" title="28"> <span class="st">&#39;__str__&#39;</span>,</a>
<a class="sourceLine" id="cb1-29" title="29"> <span class="st">&#39;__subclasshook__&#39;</span>,</a>
<a class="sourceLine" id="cb1-30" title="30"> <span class="st">&#39;clear&#39;</span>,</a>
<a class="sourceLine" id="cb1-31" title="31"> <span class="st">&#39;copy&#39;</span>,</a>
<a class="sourceLine" id="cb1-32" title="32"> <span class="st">&#39;fromkeys&#39;</span>,</a>
<a class="sourceLine" id="cb1-33" title="33"> <span class="st">&#39;get&#39;</span>,</a>
<a class="sourceLine" id="cb1-34" title="34"> <span class="st">&#39;items&#39;</span>,</a>
<a class="sourceLine" id="cb1-35" title="35"> <span class="st">&#39;keys&#39;</span>,</a>
<a class="sourceLine" id="cb1-36" title="36"> <span class="st">&#39;pop&#39;</span>,</a>
<a class="sourceLine" id="cb1-37" title="37"> <span class="st">&#39;popitem&#39;</span>,</a>
<a class="sourceLine" id="cb1-38" title="38"> <span class="st">&#39;setdefault&#39;</span>,</a>
<a class="sourceLine" id="cb1-39" title="39"> <span class="st">&#39;update&#39;</span>,</a>
<a class="sourceLine" id="cb1-40" title="40"> <span class="st">&#39;values&#39;</span>]</a></code></pre>
    </div>
    <h1 id="under-the-hood-python-dictionary">
      Under the hood : Python Dictionary
    </h1>
    <blockquote>
      <p>
        Dictionary has always been a developer’s go to tool because of the
        unique relation between the key an…
      </p>
    </blockquote>
    <figure>
      <img
        src="https://res.cloudinary.com/practicaldev/image/fetch/s--57ZfvZGb--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/i/nmsazv0iyivndokrfvi2.jpg"
        alt="Cover image for Under the hood : Python Dictionary"
      />
      <figcaption>
        Cover image for Under the hood : Python Dictionary
      </figcaption>
    </figure>
    <p>
      Dictionary has always been a developer’s go to tool because of the unique
      relation between the key and value pairs. So whenever there is any need of
      capturing frequencies, unique objects etc. in any algorithm, dictionary is
      the first thing that pops up to our head.
    </p>
    <p>Let’s dig deep into how python dictionary works under the hood.</p>
    <p>To explain it better I’ll try to relate it with a phone-book.</p>
    <p>
      Dictionary is implemented by using a data structure - hash table. The hash
      table again is a combination of two arrays - one for storing the indexes
      and the other for storing the key, values.
    </p>
    <p>
      <img
        src="https://res.cloudinary.com/practicaldev/image/fetch/s--r-Hk50vQ--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://d33wubrfki0l68.cloudfront.net/3d138e7af1264833715e47967d2dbfa8c696fb7e/ee634/images/hash-tables/hash-table-cpython-structure-high-level.svg"
      />
    </p>
    <h2 id="adding-a-new-key">
      <a href="#adding-a-new-key"></a>Adding a new key:
    </h2>
    <p>
      Initially a hash-table is always provided with a size of 8, which
      increases with the increase in num of keys.
    </p>
    <p>
      To calculate the index of the key, a hash function is used. However if we
      calculate the hash of ‘a’ in a 64 bit system, it would return a value of
      12416037344. So to avoid creation of a hash-table with such a gigantic
      size, a mask is used in a bit-wise &amp; operation along with the hash
      result.
    </p>
    <p>
      For a hash table of size ‘n’ the mask used is (2^n - 1).<br />
      This ensures that for the key, the index is never exceeding the size of
      the existing hash table.
    </p>
    <h3 id="conflict"><a href="#conflict"></a><em>Conflict:</em></h3>
    <p>
      Let’s take our phone-book example and think of a hash table with a size of
      26 each for each letter of the alphabet.
    </p>
    <p>
      Let’s save a contact by the name ‘Ajay’ and the hashing algorithm assigns
      it to the index of 5.
    </p>
    <p>
      After a few month, a new intern ‘Ashok’ joins the company, and we’ve to
      save his number. The algorithm again assigns the same index 5 to Ashok,
      but Ajay’s contact info is already present there in key, value form.
    </p>
    <p>This kind of a situation is called a <em>conflict.</em></p>
    <p>
      Now let’s think of different ways to resolve this conflict. One approach
      would be to use linked lists at each index of the hash table and the each
      individual nodes of the linked list represent a key, value pair. Such an
      approach would be a good one when we have a limited amount of data,
      however if the data size is huge, then we won’t be able to offer a read
      operation within O[1].
    </p>
    <p>
      The solution that CPython uses for conflict resolution is
      <em>re-sizing.</em>
    </p>
    <h3 id="resizing"><a href="#resizing"></a><em>Resizing:</em></h3>
    <p>
      Whenever a new key is added to a dict, CPython checks if the 2/3rd of the
      existing size is filled or not. This ratio is called the
      <em><strong>load factor</strong></em
      >, and it is an indication of whether re-sizing is required or not. If the
      load factor is 2/3 then hash table needs a re-sizing
    </p>
    <p>
      How much new space is to be added is calculated by the num_of_occupied
      spaces * 3. However the size should be a power of 2, hence the next
      highest power of 2 is chosen.
    </p>
    <p>
      Initaly it starts with a size of 8, let’s say 6 out of 8 spaces get
      occupied, then it should allocate a further more of 18 (6*3) but it
      increases the total size of the hash table to 32.
    </p>
    <p>Accordingly the indexes for the hash table are adjusted.</p>
    <h2 id="deleting-a-key"><a href="#deleting-a-key"></a>Deleting a key:</h2>
    <p>
      Similarly when an element is deleted or say multiple elements are deleted,
      the hash-table size undergoes a shrinkage. However delete item operation
      doesn’t trigger an array resize. If the number of used slots is much less
      that the total number of slots. However, when a key/value pair is added,
      the need for resize is based on the number of used slots + dummy slots so
      it can shrink the array too.
    </p>
    <h4 id="in-python-is-not-strict-equality">
      In python == is not strict equality
    </h4>
    <h4 id="strict-equality-is-denoted-with-keyword-is-as-in-10-is-10">
      strict equality is denoted with keyword ‘is’ as in: 10 is 10
    </h4>
  </body>
</html>
